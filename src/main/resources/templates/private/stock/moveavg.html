<html>
<head>
<meta charset="UTF-8">

<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>

<script>
// {{{ smooth scroll
$(function(){
	$('a[href^="#"]').click(function() {
		var speed = 400; // milli second
		var href= $(this).attr("href");
		var target = $(href == "#" || href == "" ? 'html' : href);
		var position = target.offset().top;
		$('body,html').animate({scrollTop:position}, speed, 'swing');
		return false;
	});
});
// }}}
</script>

<script src="https://www.gstatic.com/charts/loader.js"></script>
<script>

google.charts.load('current', {'packages':['corechart', 'controls']});

google.charts.setOnLoadCallback(function(){loadChart(
	'4689', 'https://docs.google.com/spreadsheets/d/1JlhOrm1CNbmj5sG8zpJ3s_JNOwjVHsluZQm33Ott4Uo/edit?usp=sharing');});

google.charts.setOnLoadCallback(function(){loadChart(
	'3402', 'https://docs.google.com/spreadsheets/d/1dw7O2P3STQGvD0W4SSHcNCjanW8QyXWiQynatPpb9iY/edit?usp=sharing');});

// {{{ function loadChart(code, url)
function loadChart(code, url) {
	var query = new google.visualization.Query(url);
	query.send(function(response) {
		var data = response.getDataTable();
		drawChart(data, code);
	});
}
// }}}

// {{{ function drawChart(data, code)
function drawChart(data, code) {

	let idDashboard = 'dboard' + code;
	let idCandle = 'candle' + code;
	let idControl = 'ctrl' + code;

	var dashboard = new google.visualization.Dashboard(document.getElementById(idDashboard));
	var chart = new google.visualization.ChartWrapper({
//		'chartType': 'CandlestickChart',
		'chartType': 'ComboChart',
		'containerId': idCandle,
		'options': {
			'title': code,
			'chartArea': {'width': '85%', 'height': '80%'},
			'legend': {'position': 'top'},
			'hAxis': {format: "yyyy/MM/dd"},
			'seriesType': 'candlesticks',
			'series': {
			    1: {'type': 'line', color: 'green'},
			    2: {'type': 'line', color: 'deepskyblue'},
			    3: {'type': 'line', color: 'deeppink'},
			}
		}
	});
	var control = new google.visualization.ControlWrapper({
		'controlType': 'ChartRangeFilter',
		'containerId': idControl,
		'options': {
			'filterColumnIndex': 0,
			'ui': {
				'chartType': 'LineChart',
				'chartOptions': {
					'chartArea': {'width': '85%', 'height': '85%'},
					'hAxis': {format: "yyyy/MM/dd"}
				},
				'chartView': {
					'columns': [0, 2]
				}
			}
		}
	});
	dashboard.bind(control, chart);
	dashboard.draw(data);
}
// }}}

</script>

<style type="text/css">
</style>

</head>
<body>

<h1>移動平均線</h1>

<div id="index">
<h2>目次</h2>
<ul>
	<li><a href="#4689">4689: Ｚホールディングス(株)</a></li>
	<li><a href="#3402">3402: 東レ(株)</a></li>
	<li><a href="#hints">ヒント</a></li>
</ul>
</div>

<div id="4689">
<a href="#index">Back to Index</a>
<h2>4689: Ｚホールディングス(株)</h2>
<div id="dboard4689">
	<div id="candle4689" style='width:100%; height: 400px;'></div>
	<div id="ctrl4689" style='width:100%; height: 100px;'></div>
</div>
</div>

<div id="3402">
<a href="#index">Back to Index</a>
<h2>4689: 東レ(株)</h2>
<div id="dboard3402">
	<div id="candle3402" style='width:100%; height: 400px;'></div>
	<div id="ctrl3402" style='width:100%; height: 100px;'></div>
</div>
</div>

<div id="hints">
<a href="#index">Back to Index</a>
<h2>ヒント</h2>
<ul>
	<li><a href="https://www.jprime.jp/articles/-/19724?page=4" target="_blank" rel="noopener">売り時・買い時を見極める株価トレンドの見方</a></li>
	<li><a href="https://www.jibunbank.co.jp/products/foreign_deposit/chart/help/sma/" target="_blank" rel="noopener">チャートの見方</a></li>
<ul>
</div>



</body>
</html>
